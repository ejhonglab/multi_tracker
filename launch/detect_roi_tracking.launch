<launch>
  <arg name="camera" default="/camera/image_raw" />
  <arg name="viewer" default="True" />
  
  <rosparam command="load" file="roi_finder.yaml" />
  <include file="$(find multi_tracker)/launch/load_tracking_parameter_yamls.launch" />
  
  <!-- TODO move / get rid of this one? -->
  <!-- maybe i want different basenames anyway? -->
  <node name="set_exp_basename" pkg="multi_tracker" type="set_basename.py" output="screen" />
  
  <!-- This will identify relevant ROIs and start instances of the single_tracking_pipeline.launch,
       with appropriate parameters. -->
  <node name="roi_finder" pkg="multi_tracker" type="roi_finder.py" output="screen" required="True">
    <remap from="/camera/image_raw" to="$(arg camera)" />
  </node>
  
  <!-- TODO try to keep this compatible w/ old code + configs while having it autodetect
       any trackers in this namespace -->
  <node name="tracking_viewer" pkg="multi_tracker" type="liveviewer.py" output="screen" required="$(arg viewer)">
      <remap from="/camera/image_raw" to="$(arg camera)" />
      
      <param name="detect_tracking_pipelines" value="True" />
      <!-- TODO also support passing through roi_* args if i'm going to continue to support 
           thos with the above flag -->
  </node>
  
  <!-- TODO fix package here after moving this file to metatools -->
  <!-- TODO equivalent of required, but just for process to finish cleanly? -->
  <node name="snapshot_params" pkg="multi_tracker" type="snapshot_params.py" output="screen" />
</launch>
